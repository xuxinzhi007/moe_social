# åç«¯å¸–å­ç³»ç»Ÿå®ç°æŒ‡å—

## ğŸ“‹ æ­¥éª¤è¯´æ˜

### 1. è¿è¡Œä»£ç ç”Ÿæˆè„šæœ¬

é¦–å…ˆéœ€è¦è¿è¡Œgo-zeroçš„ä»£ç ç”Ÿæˆå·¥å…·æ¥ç”Ÿæˆhandlerå’Œlogicçš„éª¨æ¶ä»£ç ï¼š

```bash
cd backend/api
bash generate_api.sh
```

è¿™ä¼šæ ¹æ® `super.api` æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆï¼š
- `backend/api/internal/handler/post/` - Postç›¸å…³çš„handler
- `backend/api/internal/handler/comment/` - Commentç›¸å…³çš„handler
- `backend/api/internal/logic/post/` - Postç›¸å…³çš„logic
- `backend/api/internal/logic/comment/` - Commentç›¸å…³çš„logic
- `backend/api/internal/types/` - ç±»å‹å®šä¹‰

### 2. æ›´æ–°æ•°æ®åº“æ¨¡å‹

éœ€è¦åœ¨æ•°æ®åº“åˆå§‹åŒ–æ—¶æ·»åŠ Postå’ŒCommentè¡¨ã€‚æ£€æŸ¥ `backend/utils/db.go` æ–‡ä»¶ï¼Œç¡®ä¿åŒ…å«ï¼š

```go
db.AutoMigrate(
    &model.User{},
    &model.VipPlan{},
    &model.VipOrder{},
    &model.VipRecord{},
    &model.Post{},        // æ–°å¢
    &model.PostLike{},    // æ–°å¢
    &model.Comment{},     // æ–°å¢
    &model.CommentLike{}, // æ–°å¢
)
```

### 3. å®ç°RPCæœåŠ¡ï¼ˆå¯é€‰ï¼‰

å¦‚æœä½¿ç”¨RPCæ¶æ„ï¼Œè¿˜éœ€è¦ï¼š
1. åœ¨ `backend/rpc/super.proto` ä¸­æ·»åŠ Postå’ŒCommentç›¸å…³çš„æ¶ˆæ¯å®šä¹‰
2. è¿è¡Œ `goctl rpc protoc super.proto --go_out=./pb --go-grpc_out=./pb --zrpc_out=.` ç”ŸæˆRPCä»£ç 
3. å®ç°RPC logic

### 4. å®ç°ä¸šåŠ¡é€»è¾‘

å‚è€ƒç°æœ‰çš„logicå®ç°ï¼Œå®ŒæˆPostå’ŒCommentçš„ä¸šåŠ¡é€»è¾‘ã€‚

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **IDç±»å‹è½¬æ¢**: æ•°æ®åº“ä½¿ç”¨uintï¼ŒAPIä½¿ç”¨stringï¼Œéœ€è¦è½¬æ¢
2. **å›¾ç‰‡å­˜å‚¨**: Postçš„Imageså­—æ®µå­˜å‚¨JSONæ ¼å¼çš„å­—ç¬¦ä¸²æ•°ç»„
3. **ç‚¹èµé€»è¾‘**: éœ€è¦æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç‚¹èµï¼Œé¿å…é‡å¤ç‚¹èµ
4. **è¯„è®ºè®¡æ•°**: åˆ›å»º/åˆ é™¤è¯„è®ºæ—¶éœ€è¦æ›´æ–°Postçš„Commentså­—æ®µ
5. **ç‚¹èµè®¡æ•°**: ç‚¹èµ/å–æ¶ˆç‚¹èµæ—¶éœ€è¦æ›´æ–°Post/Commentçš„Likeså­—æ®µ

## ğŸ“ å·²åˆ›å»ºçš„æ–‡ä»¶

- âœ… `backend/model/post.go` - Postå’ŒPostLikeæ¨¡å‹
- âœ… `backend/model/comment.go` - Commentå’ŒCommentLikeæ¨¡å‹
- âœ… `backend/api/super.api` - å·²æ·»åŠ Postå’ŒCommentçš„APIå®šä¹‰

## ğŸ”„ å¾…å®Œæˆçš„å·¥ä½œ

1. è¿è¡Œä»£ç ç”Ÿæˆè„šæœ¬
2. å®ç°Postç›¸å…³çš„logic
3. å®ç°Commentç›¸å…³çš„logic
4. æ›´æ–°æ•°æ®åº“è¿ç§»
5. æµ‹è¯•APIæ¥å£

