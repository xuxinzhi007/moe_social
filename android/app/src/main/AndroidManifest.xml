<manifest xmlns:android="http://schemas.android.com/apk/res/android">
    <!-- 网络权限 -->
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <!-- WiFi 信息获取权限 -->
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
    <uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />
    <!-- 语音通话与音频权限 -->
    <uses-permission android:name="android.permission.RECORD_AUDIO" />
    <uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
    <uses-permission android:name="android.permission.BLUETOOTH_CONNECT" />
    <!-- 摄像头与定位权限（用于远程监控与网络状态/定位信息） -->
    <uses-permission android:name="android.permission.CAMERA" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <!-- 后台定位权限（可选） -->
    <uses-permission android:name="android.permission.ACCESS_BACKGROUND_LOCATION" />
    <!-- 无障碍服务权限 -->
    <uses-permission android:name="android.permission.BIND_ACCESSIBILITY_SERVICE" />
    <!-- 悬浮窗权限 -->
    <uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW"/>
    <!-- 输入法切换权限（需要通过 ADB 授权：adb shell pm grant com.example.moe_social android.permission.WRITE_SECURE_SETTINGS） -->
    <uses-permission android:name="android.permission.WRITE_SECURE_SETTINGS"/>
    <!-- App 内更新所需权限 -->
    <uses-permission android:name="android.permission.REQUEST_INSTALL_PACKAGES"/>
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" android:maxSdkVersion="32"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" android:maxSdkVersion="32"/>
    
    <application
        android:label="Moe Social"
        android:name="${applicationName}"
        android:icon="@mipmap/ic_launcher"
        android:usesCleartextTraffic="true">
        <!-- 透明 Activity：用于在任意前台/后台场景弹出输入法选择器，并等待用户切换完成 -->
        <activity
            android:name=".ImePickerActivity"
            android:exported="false"
            android:excludeFromRecents="true"
            android:launchMode="singleTask"
            android:taskAffinity="com.example.moe_social.imepicker"
            android:theme="@android:style/Theme.Translucent.NoTitleBar.Fullscreen" />
        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:launchMode="singleTop"
            android:taskAffinity=""
            android:theme="@style/LaunchTheme"
            android:configChanges="orientation|keyboardHidden|keyboard|screenSize|smallestScreenSize|locale|layoutDirection|fontScale|screenLayout|density|uiMode"
            android:hardwareAccelerated="true"
            android:windowSoftInputMode="adjustResize">
            <!-- Specifies an Android theme to apply to this Activity as soon as
                 the Android process has started. This theme is visible to the user
                 while the Flutter UI initializes. After that, this theme continues
                 to determine the Window background behind the Flutter UI. -->
            <meta-data
              android:name="io.flutter.embedding.android.NormalTheme"
              android:resource="@style/NormalTheme"
              />
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
        <!-- Don't delete the meta-data below.
             This is used by the Flutter tool to generate GeneratedPluginRegistrant.java -->
        <meta-data
            android:name="flutterEmbedding"
            android:value="2" />
        
        <!-- FileProvider for App Update -->
        <provider
            android:name="androidx.core.content.FileProvider"
            android:authorities="${applicationId}.fileprovider"
            android:exported="false"
            android:grantUriPermissions="true">
            <meta-data
                android:name="android.support.FILE_PROVIDER_PATHS"
                android:resource="@xml/file_paths" />
        </provider>
        
        <!-- AutoGLM 无障碍服务 -->
        <service
            android:name=".AutoGLMAccessibilityService"
            android:label="Moe Social 助手"
            android:permission="android.permission.BIND_ACCESSIBILITY_SERVICE"
            android:exported="true">
            <intent-filter>
                <action android:name="android.accessibilityservice.AccessibilityService" />
            </intent-filter>
            <meta-data
                android:name="android.accessibilityservice"
                android:resource="@xml/accessibility_service_config" />
        </service>
    </application>
    <!-- Required to query activities that can process text, see:
         https://developer.android.com/training/package-visibility and
         https://developer.android.com/reference/android/content/Intent#ACTION_PROCESS_TEXT.

         In particular, this is used by the Flutter engine in io.flutter.plugin.text.ProcessTextPlugin. -->
    <queries>
        <intent>
            <action android:name="android.intent.action.PROCESS_TEXT"/>
            <data android:mimeType="text/plain"/>
        </intent>
        <!-- 声明要启动的应用包 (Android 11+ 包可见性要求) -->
        <intent>
            <action android:name="android.intent.action.MAIN"/>
        </intent>
        <!-- 常用应用包名 -->
        <package android:name="com.tencent.mm"/> <!-- 微信 -->
        <package android:name="com.tencent.mobileqq"/> <!-- QQ -->
        <package android:name="com.ss.android.ugc.aweme"/> <!-- 抖音 -->
        <package android:name="com.ss.android.ugc.aweme.lite"/> <!-- 抖音极速版 -->
        <package android:name="com.xingin.xhs"/> <!-- 小红书 -->
        <package android:name="com.taobao.taobao"/> <!-- 淘宝 -->
        <package android:name="com.jingdong.app.mall"/> <!-- 京东 -->
        <package android:name="tv.danmaku.bili"/> <!-- bilibili -->
        <package android:name="com.sankuai.meituan"/> <!-- 美团 -->
        <package android:name="me.ele"/> <!-- 饿了么 -->
        <package android:name="com.zhihu.android"/> <!-- 知乎 -->
        <package android:name="com.sina.weibo"/> <!-- 微博 -->
        <package android:name="com.android.settings"/> <!-- 设置 -->
        <package android:name="com.android.chrome"/> <!-- Chrome -->
        <package android:name="com.smile.gifmaker"/> <!-- 快手 -->
        <package android:name="com.kuaishou.nebula"/> <!-- 快手极速版 -->
        <package android:name="com.eg.android.AlipayGphone"/> <!-- 支付宝 -->
        <package android:name="com.xunmeng.pinduoduo"/> <!-- 拼多多 -->
        <package android:name="com.taobao.idlefish"/> <!-- 闲鱼 -->
        <package android:name="com.netease.cloudmusic"/> <!-- 网易云音乐 -->
        <package android:name="com.tencent.qqmusic"/> <!-- QQ音乐 -->
        <package android:name="com.kugou.android"/> <!-- 酷狗音乐 -->
        <package android:name="com.autonavi.minimap"/> <!-- 高德地图 -->
        <package android:name="com.baidu.BaiduMap"/> <!-- 百度地图 -->
        <package android:name="com.ss.android.article.news"/> <!-- 今日头条 -->
        <package android:name="com.android.adbkeyboard"/> <!-- ADB Keyboard -->
    </queries>
</manifest>
